<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ù–∞–π–¥–∏ –ø–∞—Ä—ã</title>
  <style>
    * { box-sizing: border-box; }
    body { font-family: 'Segoe UI', system-ui, sans-serif; padding: 24px; margin: 0; background: linear-gradient(135deg, #0d1117 0%, #161b22 50%, #21262d 100%); color: #e6edf3; min-height: 100vh; }
    h1 { font-size: 1.5rem; margin: 0 0 8px; font-weight: 700; }
    .subtitle { color: #8b949e; margin: 0 0 20px; font-size: 0.9rem; }
    .toolbar { display: flex; gap: 16px; flex-wrap: wrap; align-items: center; margin-bottom: 24px; }
    .toolbar select { padding: 10px 14px; font-size: 0.95rem; background: #21262d; border: 1px solid #30363d; color: #e6edf3; border-radius: 8px; cursor: pointer; }
    .toolbar .btn { padding: 10px 20px; font-size: 0.95rem; font-weight: 600; background: #238636; color: #fff; border: none; border-radius: 8px; cursor: pointer; transition: transform 0.2s; }
    .toolbar .btn:hover { transform: translateY(-1px); }
    .stats { display: flex; gap: 20px; margin-bottom: 20px; }
    .stat { padding: 8px 16px; background: #21262d; border-radius: 8px; }
    .stat span { color: #8b949e; font-size: 0.85rem; }
    .stat strong { font-size: 1.2rem; color: #58a6ff; margin-left: 6px; }
    .grid { display: grid; gap: 12px; max-width: 520px; margin: 0 auto; }
    .grid.size-8 { grid-template-columns: repeat(4, 1fr); }
    .grid.size-12 { grid-template-columns: repeat(4, 1fr); }
    .grid.size-16 { grid-template-columns: repeat(4, 1fr); }
    .card { aspect-ratio: 1; border-radius: 12px; border: 2px solid #30363d; background: linear-gradient(135deg, #21262d, #161b22); cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; font-weight: bold; color: transparent; transition: transform 0.2s, background 0.2s, color 0.2s; user-select: none; }
    .card:hover { transform: scale(1.03); border-color: #58a6ff; }
    .card.flipped, .card.matched { color: #e6edf3; background: linear-gradient(135deg, #238636, #2ea043); border-color: #3fb950; cursor: default; }
    .card.flipped { background: linear-gradient(135deg, #388bfd, #58a6ff); border-color: #58a6ff; }
    .card.matched { animation: match 0.4s ease; }
    @keyframes match { 0% { transform: scale(1); } 50% { transform: scale(1.08); } 100% { transform: scale(1); } }
    .card .back { font-size: 1.4rem; color: #484f58; display: block; }
.card .face { display: none; font-size: 1.8rem; }
.card.flipped .back, .card.matched .back { display: none; }
.card.flipped .face, .card.matched .face { display: block !important; }
    .win-msg { margin-top: 24px; padding: 20px; background: rgba(35, 134, 54, 0.2); border: 1px solid #238636; border-radius: 12px; font-size: 1.1rem; text-align: center; display: none; }
    .win-msg.show { display: block; animation: fadeIn 0.4s ease; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .voice-toggle { display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 0.9rem; color: #8b949e; margin-left: 12px; }
    .voice-toggle input { width: auto; }
    .speak-btn { padding: 8px 16px; font-size: 0.9rem; background: #21262d; color: #8b949e; border: 1px solid #30363d; border-radius: 8px; cursor: pointer; }
    .speak-btn:hover, .speak-btn:focus { background: #30363d; color: #e6edf3; }
    button:focus-visible, select:focus-visible, [role="button"]:focus-visible { outline: 3px solid #58a6ff; outline-offset: 2px; }
    .keyboard-hint { font-size: 0.8rem; color: #8b949e; margin-bottom: 12px; }
  </style>
</head>
<body>
  <main role="main" aria-label="–ò–≥—Ä–∞ –ù–∞–π–¥–∏ –ø–∞—Ä—ã">
  <h1>–ù–∞–π–¥–∏ –ø–∞—Ä—ã</h1>
  <p class="keyboard-hint" id="keyboardHint">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: Tab - –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–∞–º –∏ –∫–Ω–æ–ø–∫–∞–º, Enter –∏–ª–∏ –ü—Ä–æ–±–µ–ª - –æ—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –∏–ª–∏ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É.</p>
  <p class="subtitle" id="instructions">–û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ –Ω–∞—Ö–æ–¥–∏—Ç–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å–∏–º–≤–æ–ª—ã. –ú–µ–Ω—å—à–µ —Ö–æ–¥–æ–≤ - –ª—É—á—à–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!</p>
  <button type="button" class="speak-btn" id="introBtn" aria-label="–û–∑–≤—É—á–∏—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é">–ö–∞–∫ –∏–≥—Ä–∞—Ç—å</button>
  <div class="toolbar">
    <label>–°–ª–æ–∂–Ω–æ—Å—Ç—å:
      <select id="size">
        <option value="8">8 –∫–∞—Ä—Ç (4 –ø–∞—Ä—ã)</option>
        <option value="12" selected>12 –∫–∞—Ä—Ç (6 –ø–∞—Ä)</option>
        <option value="16">16 –∫–∞—Ä—Ç (8 –ø–∞—Ä)</option>
      </select>
    </label>
    <button type="button" class="btn" id="newGame">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
    <label class="voice-toggle"><input type="checkbox" id="voiceOn" checked> –û–∑–≤—É—á–∏–≤–∞—Ç—å</label>
    <button type="button" class="speak-btn" id="repeatBtn" aria-label="–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ">–ü–æ–≤—Ç–æ—Ä–∏—Ç—å</button>
  </div>
  <div class="stats">
    <div class="stat">–•–æ–¥—ã: <strong id="moves">0</strong></div>
    <div class="stat">–ü–∞—Ä—ã: <strong id="pairs">0</strong> / <span id="totalPairs">6</span></div>
  </div>
  <div class="grid size-12" id="grid"></div>
  <div class="win-msg" id="winMsg">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –Ω–∞—à–ª–∏ –≤—Å–µ –ø–∞—Ä—ã –∑–∞ <strong id="finalMoves">0</strong> —Ö–æ–¥–æ–≤.</div>
  </main>
  <script>
    var emoji = ['üåü', 'üéØ', 'üî•', 'üíé', 'üé∏', 'üöÄ', 'üåà', '‚ö°', 'üé®', 'üçÄ', 'üé™', 'üé≠', 'üèÜ', 'üå∫', 'üé≤', 'ü¶ã'];
    var emojiNames = ['–∑–≤–µ–∑–¥–∞', '—Ü–µ–ª—å', '–æ–≥–æ–Ω—å', '–±—Ä–∏–ª–ª–∏–∞–Ω—Ç', '–≥–∏—Ç–∞—Ä–∞', '—Ä–∞–∫–µ—Ç–∞', '—Ä–∞–¥—É–≥–∞', '–º–æ–ª–Ω–∏—è', '–ø–∞–ª–∏—Ç—Ä–∞', '–∫–ª–µ–≤–µ—Ä', '—Ü–∏—Ä–∫', '–º–∞—Å–∫–∞', '–∫—É–±–æ–∫', '—Ü–≤–µ—Ç–æ–∫', '–∫—É–±–∏–∫', '–±–∞–±–æ—á–∫–∞'];
    var gridEl = document.getElementById('grid');
    var movesEl = document.getElementById('moves');
    var pairsEl = document.getElementById('pairs');
    var totalPairsEl = document.getElementById('totalPairs');
    var winMsgEl = document.getElementById('winMsg');
    var finalMovesEl = document.getElementById('finalMoves');
    var cards = [];
    var flipped = [];
    var moves = 0;
    var pairsFound = 0;
    var totalPairs = 6;
    var lock = false;
    var voiceOn = localStorage.getItem('pamjat_voice') !== '0';
    if (document.getElementById('voiceOn')) document.getElementById('voiceOn').checked = voiceOn;
    function say(t) {
      if (!voiceOn || !window.speechSynthesis || !t) return;
      window.speechSynthesis.cancel();
      var u = new SpeechSynthesisUtterance(t);
      u.lang = 'ru-RU';
      u.rate = 0.9;
      window.speechSynthesis.speak(u);
    }
    function nameForSymbol(sym) {
      var i = emoji.indexOf(sym);
      return i >= 0 ? emojiNames[i] : sym;
    }
    function getPairsCount() {
      var n = parseInt(document.getElementById('size').value, 10) || 12;
      return n / 2;
    }
    function buildDeck() {
      var count = getPairsCount();
      totalPairs = count;
      totalPairsEl.textContent = count;
      var symbols = emoji.slice(0, count);
      var deck = symbols.concat(symbols);
      for (var i = deck.length - 1; i > 0; i--) {
        var j = Math.floor(Math.random() * (i + 1));
        var t = deck[i]; deck[i] = deck[j]; deck[j] = t;
      }
      return deck;
    }
    function render() {
      var count = getPairsCount() * 2;
      gridEl.innerHTML = '';
      gridEl.className = 'grid size-' + count;
      cards = buildDeck();
      cards.forEach(function(symbol, index) {
        var div = document.createElement('div');
        div.className = 'card';
        div.setAttribute('data-index', index);
        div.setAttribute('data-symbol', symbol);
        div.setAttribute('aria-label', '–ö–∞—Ä—Ç–æ—á–∫–∞ ' + (index + 1) + ', –∑–∞–∫—Ä—ã—Ç–∞');
        div.setAttribute('role', 'button');
        div.setAttribute('tabindex', '0');
        div.innerHTML = '<span class="back">?</span><span class="face" aria-hidden="true">' + symbol + '</span>';
        div.addEventListener('click', function() { flip(index); });
        div.addEventListener('keydown', function(e) { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); flip(index); } });
        gridEl.appendChild(div);
      });
      moves = 0;
      pairsFound = 0;
      flipped = [];
      lock = false;
      movesEl.textContent = '0';
      pairsEl.textContent = '0';
      winMsgEl.classList.remove('show');
    }
    function flip(index) {
      if (lock) return;
      var card = gridEl.children[index];
      if (!card || card.classList.contains('flipped') || card.classList.contains('matched')) return;
      card.classList.add('flipped');
      var sym = card.getAttribute('data-symbol');
      card.setAttribute('aria-label', '–ö–∞—Ä—Ç–æ—á–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞: ' + nameForSymbol(sym));
      say('–û—Ç–∫—Ä—ã—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∞: ' + nameForSymbol(sym));
      flipped.push({ index: index, symbol: sym, el: card });
      if (flipped.length === 2) {
        moves++;
        movesEl.textContent = moves;
        lock = true;
        if (flipped[0].symbol === flipped[1].symbol) {
          flipped[0].el.classList.remove('flipped');
          flipped[0].el.classList.add('matched');
          flipped[1].el.classList.remove('flipped');
          flipped[1].el.classList.add('matched');
          pairsFound++;
          pairsEl.textContent = pairsFound;
          flipped[0].el.setAttribute('aria-label', '–ü–∞—Ä–∞ –Ω–∞–π–¥–µ–Ω–∞: ' + nameForSymbol(flipped[0].symbol));
          flipped[1].el.setAttribute('aria-label', '–ü–∞—Ä–∞ –Ω–∞–π–¥–µ–Ω–∞: ' + nameForSymbol(flipped[1].symbol));
          say('–ü–∞—Ä–∞ –Ω–∞–π–¥–µ–Ω–∞. –í—Å–µ–≥–æ –ø–∞—Ä: ' + pairsFound + ' –∏–∑ ' + totalPairs);
          flipped = [];
          lock = false;
          if (pairsFound === totalPairs) {
            finalMovesEl.textContent = moves;
            winMsgEl.classList.add('show');
            say('–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞. –í—ã –Ω–∞—à–ª–∏ –≤—Å–µ –ø–∞—Ä—ã –∑–∞ ' + moves + ' —Ö–æ–¥–æ–≤.');
          }
        } else {
          var n1 = flipped[0].index + 1;
          var n2 = flipped[1].index + 1;
          var name1 = nameForSymbol(flipped[0].symbol);
          var name2 = nameForSymbol(flipped[1].symbol);
          say('–ù–µ –ø–∞—Ä–∞. –ö–∞—Ä—Ç–æ—á–∫–∞ ' + n1 + ': ' + name1 + '. –ö–∞—Ä—Ç–æ—á–∫–∞ ' + n2 + ': ' + name2 + '. –ó–∞–ø–æ–º–Ω–∏—Ç–µ –∏ –Ω–∞–π–¥–∏—Ç–µ –ø–∞—Ä—ã.');
          setTimeout(function() {
            flipped[0].el.classList.remove('flipped');
            flipped[0].el.setAttribute('aria-label', '–ö–∞—Ä—Ç–æ—á–∫–∞ ' + n1 + ', –∑–∞–∫—Ä—ã—Ç–∞');
            flipped[1].el.classList.remove('flipped');
            flipped[1].el.setAttribute('aria-label', '–ö–∞—Ä—Ç–æ—á–∫–∞ ' + n2 + ', –∑–∞–∫—Ä—ã—Ç–∞');
            flipped = [];
            lock = false;
          }, 700);
        }
      }
    }
    document.getElementById('newGame').addEventListener('click', render);
    document.getElementById('size').addEventListener('change', function() {
      render();
    });
    document.getElementById('repeatBtn').addEventListener('click', function() {
      var msg = '–•–æ–¥–æ–≤: ' + moves + '. –ü–∞—Ä –Ω–∞–π–¥–µ–Ω–æ: ' + pairsFound + ' –∏–∑ ' + totalPairs;
      if (pairsFound === totalPairs) msg = '–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞. –í—Å–µ –ø–∞—Ä—ã –∑–∞ ' + moves + ' —Ö–æ–¥–æ–≤.';
      say(msg);
    });
    document.getElementById('voiceOn').addEventListener('change', function() {
      voiceOn = this.checked;
      localStorage.setItem('pamjat_voice', voiceOn ? '1' : '0');
      if (voiceOn) document.getElementById('repeatBtn').click();
    });
    document.getElementById('introBtn').addEventListener('click', function() {
      say('–ü–∞–º—è—Ç—å - –Ω–∞–π–¥–∏ –ø–∞—Ä—ã. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã: Tab - –ø–µ—Ä–µ—Ö–æ–¥ –ø–æ –∫–∞—Ä—Ç–æ—á–∫–∞–º –∏ –∫–Ω–æ–ø–∫–∞–º, Enter –∏–ª–∏ –ü—Ä–æ–±–µ–ª - –æ—Ç–∫—Ä—ã—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –∏–ª–∏ –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É. –î–≤–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º —Å–∏–º–≤–æ–ª–æ–º - –ø–∞—Ä–∞. –ó–∞–ø–æ–º–Ω–∏—Ç–µ –ø–æ–∑–∏—Ü–∏–∏. –í—ã–±–µ—Ä–∏—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å: 4, 6 –∏–ª–∏ 8 –ø–∞—Ä.');
    });
    render();
  </script>
</body>
</html>
